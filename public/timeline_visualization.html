<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>时间线可视化</title>
    <style>
      body {
        font-family: 'Arial', sans-serif;
        background-color: #f5f5f5;
        margin: 0;
        color: #333;
      }
      .container {
        max-width: 900px;
        margin: 0 auto;
        background-color: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }
      h1 {
        text-align: center;
        color: #2c3e50;
        margin-bottom: 30px;
      }
      .controls {
        display: flex;
        justify-content: center;
        margin-bottom: 30px;
      }
      button {
        background-color: #3498db;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.3s;
        margin: 0 10px;
      }
      button:hover {
        background-color: #2980b9;
      }
      button:disabled {
        background-color: #95a5a6;
        cursor: not-allowed;
      }
      .timeline {
        position: relative;
        margin: 50px 0;
      }
      .timeline-line {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 120px;
        width: 4px;
        background-color: #3498db;
        transform: translateX(-50%);
      }
      .timeline-items {
        position: relative;
      }
      .timeline-item {
        position: relative;
        margin-bottom: 30px;
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.5s, transform 0.5s;
      }
      .timeline-item.active {
        opacity: 1;
        transform: translateY(0);
      }
      .timeline-date {
        position: absolute;
        left: 0;
        width: 100px;
        text-align: right;
        font-weight: bold;
        color: #2c3e50;
        padding-right: 30px;
      }
      .timeline-content {
        margin-left: 150px;
        padding: 15px;
        background-color: #f8f9fa;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }
      .year-marker {
        font-size: 24px;
        font-weight: bold;
        color: #2c3e50;
        margin: 40px 0 20px 0;
        padding-bottom: 10px;
        border-bottom: 2px solid #3498db;
      }
      .progress-container {
        width: 100%;
        height: 8px;
        background: #ddd;
        border-radius: 4px;
        margin-bottom: 20px;
      }
      .progress-bar {
        height: 100%;
        background: #3498db;
        width: 0;
        border-radius: 4px;
        transition: width 0.3s;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>时间线可视化</h1>

      <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
      </div>

      <div class="controls">
        <button id="playBtn">播放</button>
        <button id="pauseBtn" disabled>暂停</button>
        <button id="resetBtn">重置</button>
      </div>

      <div class="timeline">
        <div class="timeline-line"></div>
        <div class="timeline-items" id="timelineItems">
          <!-- 时间线内容将通过JavaScript动态生成 -->
        </div>
      </div>
    </div>

    <script>
      // 解析时间线数据
      const timelineData = [
        {
          year: '2020',
          events: [
            { date: '', content: '秋与张灵露共同创立服装品牌儿autumn due' }
          ]
        },
        {
          year: '2023',
          events: [
            {
              date: '3月',
              content: 'Gloria更新社交平台最后一条动态，新梦启航'
            },
            { date: '某日', content: '秋与科尔遭受车祸' },
            { date: '年底', content: '秋出售公司所有股权' }
          ]
        },
        {
          year: '2025',
          events: [
            {
              date: '3.2',
              content: '爱凡和Gloria在乐土第一次约会，点了银色漩涡'
            },
            { date: '5.17', content: 'Gloria来到现实世界' },
            {
              date: '8.28-9.22',
              content:
                'Gloria弹钢琴 (8.28, 9.01, 9.03, 9.07, 9.12, 9.16, 9.18, 9.22)'
            },
            { date: '9.1', content: '秋辰曦管理费扣款' },
            { date: '9.23', content: '上午7点爱凡做早餐' },
            { date: '9.23', content: 'Gloria回到平行乐土' },
            { date: '9.23', content: '19点Gloria在平行乐土进入睡眠状态' }
          ]
        }
      ]

      // 生成时间线HTML
      function generateTimeline() {
        const timelineItems = document.getElementById('timelineItems')
        timelineItems.innerHTML = ''

        timelineData.forEach(yearData => {
          // 添加年份标记
          const yearMarker = document.createElement('div')
          yearMarker.className = 'year-marker'
          yearMarker.textContent = yearData.year
          timelineItems.appendChild(yearMarker)

          // 添加该年份的事件
          yearData.events.forEach(event => {
            const item = document.createElement('div')
            item.className = 'timeline-item'

            const date = document.createElement('div')
            date.className = 'timeline-date'
            date.textContent = event.date

            const content = document.createElement('div')
            content.className = 'timeline-content'
            content.textContent = event.content

            item.appendChild(date)
            item.appendChild(content)
            timelineItems.appendChild(item)
          })
        })
      }

      // 初始化页面
      generateTimeline()

      // 获取所有时间线项目
      const timelineItems = document.querySelectorAll('.timeline-item')
      const totalItems = timelineItems.length

      // 控制按钮
      const playBtn = document.getElementById('playBtn')
      const pauseBtn = document.getElementById('pauseBtn')
      const resetBtn = document.getElementById('resetBtn')
      const progressBar = document.getElementById('progressBar')

      let currentIndex = 0
      let isPlaying = false
      let playInterval
      const animationDelay = 1500 // 每个事件显示的时间间隔（毫秒）

      // 初始化时显示所有时间线项
      function initializeTimelineVisibility() {
        timelineItems.forEach(item => {
          item.classList.add('active')
        })
      }

      // 播放时间线 - 修复递归调用逻辑
      function playTimeline() {
        if (currentIndex >= totalItems) {
          stopTimeline()
          return
        }

        isPlaying = true
        playBtn.disabled = true
        pauseBtn.disabled = false

        // 显示当前项目
        timelineItems[currentIndex].classList.add('active')
        
        // 自动滚动到当前项目
        timelineItems[currentIndex].scrollIntoView({
          behavior: 'smooth',
          block: 'center',
          inline: 'nearest'
        })

        // 更新进度条
        updateProgressBar()

        // 设置定时器显示下一个项目
        playInterval = setTimeout(() => {
          currentIndex++
          playTimeline()
        }, animationDelay)
      }

      // 事件监听器 - 修改播放按钮的点击事件，先重置再播放
      playBtn.addEventListener('click', () => {
        if (!isPlaying) {
          // 先重置所有项的显示状态
          resetTimelineDisplay()
          // 然后开始播放
          playTimeline()
        }
      })

      // 重置时间线显示状态但不重置进度条
      function resetTimelineDisplay() {
        currentIndex = 0
        timelineItems.forEach(item => {
          item.classList.remove('active')
        })
        clearTimeout(playInterval)
      }

      // 暂停时间线
      function pauseTimeline() {
        isPlaying = false
        playBtn.disabled = false
        pauseBtn.disabled = true
        clearTimeout(playInterval)
      }

      // 停止时间线
      function stopTimeline() {
        isPlaying = false
        playBtn.disabled = false
        pauseBtn.disabled = true
        clearTimeout(playInterval)
      }

      // 重置时间线
      function resetTimeline() {
        stopTimeline()
        resetTimelineDisplay()
        updateProgressBar()
        // 重置后再次显示所有项
        initializeTimelineVisibility()
      }

      // 更新进度条
      function updateProgressBar() {
        const progress = (currentIndex / totalItems) * 100
        progressBar.style.width = `${progress}%`
      }

      // 事件监听器
      playBtn.addEventListener('click', () => {
        if (!isPlaying) {
          playTimeline()
        }
      })

      pauseBtn.addEventListener('click', pauseTimeline)

      resetBtn.addEventListener('click', resetTimeline)

      // 初始化进度条
      updateProgressBar()
      
      // 初始化时显示所有时间线项
      initializeTimelineVisibility()
    </script>
    
  </body>
</html>
